<!DOCTYPE html>
<html>
<head>
    <title>Game Hub</title>
    <style>
        body { background:#000; color:#fff; font-family:sans-serif; padding:20px; text-align:center; }
        #game-menu { margin-bottom:20px; }
        .game-btn { margin:5px; padding:10px 20px; font-size:16px; cursor:pointer; }
        #emulator-container { display:none; }
        #canvas { border:2px solid #0f0; max-width:100%; margin-top:20px; }
        #back-btn { margin-top:10px; }
        #status { margin-top:12px; color:#8f8; }
    </style>
</head>
<body>
    <h1>ðŸŽ® Game Hub</h1>
    
    <!-- Game Selection Menu -->
    <div id="game-menu">
        <h2>Choose a Game:</h2>
        <button class="game-btn" onclick="loadGame('nes', 'games/super-mario.nes')">Super Mario Bros</button>
        <button class="game-btn" onclick="loadGame('gba', 'games/emerald.gba')">PokÃ©mon Emerald</button>
        <button class="game-btn" onclick="loadGame('snes', 'games/zelda.smc')">Zelda: LTTP</button>
    </div>
    
    <!-- Emulator Container -->
    <div id="emulator-container">
        <div id="status"></div>
        <canvas id="canvas"></canvas><br>
        <button id="back-btn" onclick="location.reload()">Back to Games</button>
    </div>
    
    <script>
        function showStatus(msg, isError) {
            const s = document.getElementById('status');
            if (!s) return;
            s.textContent = msg;
            s.style.color = isError ? '#f88' : '#8f8';
        }

        function loadGame(system, gamePath) {
            // Hide menu, show emulator
            document.getElementById('game-menu').style.display = 'none';
            document.getElementById('emulator-container').style.display = 'block';
            showStatus('Preparing emulator...');

            // Configure emulator (use lowercase core names)
            window.EJS_player = '#canvas';
            window.EJS_gameUrl = gamePath;
            window.EJS_core = (system || '').toLowerCase();
            window.EJS_startOnLoaded = true;

            // Warn if served over file:// â€” the emulator often requires HTTP
            if (location.protocol === 'file:') {
                showStatus('Running from file:// â€” start a local HTTP server (see instructions).', true);
            }

            // Load emulator script with handlers
            const script = document.createElement('script');
            script.src = 'https://cdn.emulatorjs.org/stable/data/loader.js';
            script.crossOrigin = 'anonymous';
            script.onload = () => {
                showStatus('Emulator script loaded â€” launching game...');
                console.log('Emulator loader loaded');
            };
            script.onerror = () => {
                showStatus('Failed to load emulator script. Check network or run via HTTP server.', true);
                console.error('Failed to load emulator loader from', script.src);
            };
            document.body.appendChild(script);
        }
    </script>
</body>
</html>
